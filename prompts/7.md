# Prompt 7: Polish & Animations

**Priority:** P2 (Nice to have)
**Focus:** UI/UX Polish
**Skill Required:** None (React Native animations)

---

## Pre-Flight Checklist

1. **Read issues first:** Check `docs/issues/ui/README.md`
2. **Ensure E2E testing complete:** Prompt 6 should be done
3. **Check current animations:**
   ```bash
   grep -rn "Animated\|useAnimated\|reanimated" mobile/components/
   ```

---

## Context

The core functionality is complete. This prompt focuses on polish:
- Smooth animations
- Haptic feedback
- Loading states
- Micro-interactions

---

## Requirements

### 1. Swipe Card Animations

Enhance `mobile/components/prediction/SwipeCard.tsx`:

```typescript
// Card rotation based on drag
const cardRotation = interpolate(
  translateX.value,
  [-SCREEN_WIDTH / 2, 0, SCREEN_WIDTH / 2],
  [-15, 0, 15],
  Extrapolate.CLAMP
);

// Opacity fade for overlay
const yesOverlayOpacity = interpolate(
  translateX.value,
  [0, SWIPE_THRESHOLD],
  [0, 1],
  Extrapolate.CLAMP
);
```

Add:
- Card tilt on drag
- YES/NO overlay fade-in
- Card exit animation (fly off screen)
- Next card scale-up

### 2. Haptic Feedback

Create `mobile/lib/haptics.ts`:

```typescript
import * as Haptics from 'expo-haptics';

export const haptics = {
  light: () => Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light),
  medium: () => Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium),
  heavy: () => Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Heavy),
  success: () => Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success),
  error: () => Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error),
};
```

Add haptics to:
- Swipe threshold reached
- Bet placed successfully
- Bet failed
- Winnings claimed
- Pull to refresh

### 3. Button Press Animations

Create reusable `AnimatedPressable`:

```typescript
const AnimatedPressable = ({ children, onPress, ...props }) => {
  const scale = useSharedValue(1);

  const animatedStyle = useAnimatedStyle(() => ({
    transform: [{ scale: scale.value }],
  }));

  const onPressIn = () => {
    scale.value = withSpring(0.95);
  };

  const onPressOut = () => {
    scale.value = withSpring(1);
  };

  return (
    <Animated.View style={animatedStyle}>
      <Pressable onPress={onPress} onPressIn={onPressIn} onPressOut={onPressOut}>
        {children}
      </Pressable>
    </Animated.View>
  );
};
```

### 4. Loading Skeletons

Create `mobile/components/shared/Skeleton.tsx`:

```typescript
// Shimmer effect for loading states
const Skeleton = ({ width, height, borderRadius = 8 }) => {
  const shimmer = useSharedValue(0);

  useEffect(() => {
    shimmer.value = withRepeat(
      withTiming(1, { duration: 1500 }),
      -1,
      false
    );
  }, []);

  return (
    <Animated.View style={[{ width, height, borderRadius }, shimmerStyle]} />
  );
};
```

Add skeletons for:
- Market cards loading
- Position cards loading
- Profile stats loading

### 5. Number Animations

Animate numbers when they change:
- Balance updates
- Win amount reveals
- Leaderboard position changes

```typescript
const AnimatedNumber = ({ value, prefix = '' }) => {
  const animatedValue = useSharedValue(0);

  useEffect(() => {
    animatedValue.value = withTiming(value, { duration: 800 });
  }, [value]);

  return <AnimatedText text={`${prefix}${animatedValue.value.toFixed(2)}`} />;
};
```

### 6. Screen Transitions

Configure smooth screen transitions in layouts:

```typescript
// Tab bar slide animation
const tabBarAnimation = {
  animation: 'spring',
  config: {
    stiffness: 500,
    damping: 40,
    mass: 1,
  },
};
```

### 7. Celebration Effects

Enhance `WelcomeBonusAnimation.tsx`:
- Confetti burst on big wins
- Coin shower animation
- Streak celebration

---

## Implementation Steps

1. **Install dependencies** - Verify reanimated, expo-haptics
2. **Create haptics utility** - Centralized haptic functions
3. **Enhance SwipeCard** - Add tilt, overlays, exit animation
4. **Create AnimatedPressable** - Reusable button component
5. **Add loading skeletons** - For all loading states
6. **Animate numbers** - Balance, wins, stats
7. **Add haptics throughout** - Key interactions
8. **Test animations** - 60 FPS, no jank

---

## Verification

```bash
# Check animation dependencies
cd mobile && npm ls react-native-reanimated expo-haptics
```

Visual verification:
- [ ] Card swipe feels smooth and responsive
- [ ] Card tilts naturally during drag
- [ ] YES/NO overlays fade in properly
- [ ] Buttons scale on press
- [ ] Loading skeletons shimmer
- [ ] Numbers animate on change
- [ ] Haptic feedback on key actions
- [ ] No frame drops (60 FPS)

---

## Do NOT

- Add animations that slow down interactions
- Make animations too long (keep < 300ms)
- Add haptics to every touch (only meaningful ones)
- Break accessibility (ensure VoiceOver still works)
- Overcomplicate simple interactions

---

## Deliverables

1. Enhanced SwipeCard animations
2. `mobile/lib/haptics.ts` utility
3. `AnimatedPressable` component
4. `Skeleton` component
5. `AnimatedNumber` component
6. Haptics throughout app
7. Smooth 60 FPS experience

---

## Post-Completion

1. Document animation patterns in `docs/issues/ui/README.md`
2. Delete this prompt file: `rm prompts/7.md`
3. Report: "completed prompt 7"
